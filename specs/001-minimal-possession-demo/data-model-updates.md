# Data-Model.md Updates - Copy-Paste Ready

## Replace ยง ActivityLogEntry Section (Lines ~299-325)

---

### ActivityLogEntry

**Purpose**: Record of NPC action for display in activity log UI

**Fields**:

- `Id` (ObjectId): Auto-generated unique identifier (LiteDB)
- `Timestamp` (DateTime): When action occurred
- `ActorId` (string): NPC ID who performed action
- `ActorName` (string): NPC name for display
- `ActionName` (string): Action performed
- `Result` (string): Human-readable outcome, e.g., "+5 gold, +2 reputation"

**Validation Rules**:

- `Timestamp` must be <= current WorldTime
- `ActorId` should reference valid NPC (soft validation, not enforced)
- `Id` auto-generated by LiteDB on insert

**Persistence** (UPDATED - resolves ambiguity):

- Stored in LiteDB "activityLog" collection (NOT transient)
- Retention: Last 100 entries (automatic FIFO cleanup on insert)
- Indexed by Timestamp (descending) for efficient recent-first queries
- No TTL expiration (manual cleanup only)
- Query: `db.GetCollection<ActivityLogEntry>("activityLog").Find(Query.All(Query.Descending), limit: 20)`

**C# Schema**:

```csharp
using LiteDB;

public sealed record ActivityLogEntry(
    ObjectId Id,           // Auto-generated by LiteDB
    DateTime Timestamp,
    string ActorId,
    string ActorName,
    string ActionName,
    string Result);

// Factory method for creating new entries (Id assigned on insert)
public static ActivityLogEntry Create(string actorId, string actorName, string actionName, string result)
{
    return new ActivityLogEntry(
        Id: ObjectId.Empty,  // LiteDB assigns on insert
        Timestamp: DateTime.UtcNow,
        ActorId: actorId,
        ActorName: actorName,
        ActionName: actionName,
        Result: result
    );
}
```

**Rationale for Persistence Change**:

- Original spec said "transient, not persisted" to simplify MVP
- LiteDB storage enables:
  - Activity log survives page refresh (better UX)
  - Offline progress summary can reference historical actions
  - Future feature: Export activity history
- Performance impact: Negligible (<5ms per insert, see PR-003)
- Storage impact: ~100 entries ร ~200 bytes = 20 KB (acceptable)

---
